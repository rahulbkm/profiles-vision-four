<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamics 365 - Editing Routing Profile</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont,
                Roboto, 'Helvetica Neue', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
            background-color: #f3f2f1;
        }

        /* Header Styles */
        .header {
            height: 48px;
            background-color: #1b3a57;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            color: white;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .waffle-menu {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 2px;
        }

        .waffle-menu:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .header-title {
            font-size: 15px;
            font-weight: 600;
        }

        .header-subtitle {
            color: white;
            text-decoration: underline;
            font-size: 13px;
        }

        .header-subtitle:hover {
            text-decoration: none;
        }

        .header-center {
            flex: 1;
            max-width: 600px;
            margin: 0 40px;
        }

        .search-box {
            position: relative;
            width: 100%;
        }

        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
        }

        .search-input {
            width: 100%;
            height: 32px;
            padding: 0 12px 0 36px;
            border: none;
            border-radius: 2px;
            font-size: 14px;
            background-color: white;
        }

        .search-input:focus {
            outline: 2px solid #0078d4;
            outline-offset: -2px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .icon-button {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 2px;
            width: 32px;
            height: 32px;
        }

        .icon-button:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .avatar-button {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0;
        }

        .avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: #0078d4;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
        }

        /* Main Content */
        .main-content {
            margin-top: 48px;
            background-color: #f3f2f1;
            min-height: calc(100vh - 48px);
        }

        .page-header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 24px;
            background-color: white;
            border-bottom: 1px solid #edebe9;
        }

        .header-bar-left {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .back-button {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            border-radius: 2px;
            display: flex;
            align-items: center;
            color: #0078d4;
        }

        .back-button:hover {
            background-color: #f3f2f1;
        }

        .save-button {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background-color: #0078d4;
            color: white;
            border: none;
            border-radius: 2px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
        }

        .save-button:hover {
            background-color: #106ebe;
        }

        .header-bar-right {
            display: flex;
            align-items: center;
        }

        .download-link {
            display: flex;
            align-items: center;
            gap: 6px;
            color: #0078d4;
            text-decoration: none;
            font-size: 14px;
            padding: 6px 12px;
            border-radius: 2px;
        }

        .download-link:hover {
            background-color: #f3f2f1;
            text-decoration: underline;
        }

        .page-header {
            padding: 24px 24px 16px;
            background-color: white;
            border-bottom: 1px solid #edebe9;
        }

        .edit-title {
            font-size: 24px;
            font-weight: 600;
            color: #323130;
            margin: 0 0 4px 0;
        }

        .edit-subtitle {
            font-size: 14px;
            color: #605e5c;
            margin: 0;
        }

        .edit-content-layout {
            display: flex;
            background-color: white;
            min-height: 600px;
        }

        .edit-sidebar {
            width: 200px;
            background-color: #faf9f8;
            border-right: 1px solid #edebe9;
            padding: 0;
        }

        .edit-tabs {
            display: flex;
            flex-direction: column;
        }

        .edit-tab {
            background: none;
            border: none;
            border-left: 3px solid transparent;
            text-align: left;
            padding: 12px 16px 12px 36px;
            font-size: 14px;
            color: #323130;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .edit-tab:hover {
            background-color: #f3f2f1;
        }

        .edit-tab.active {
            background-color: white;
            border-left-color: #0078d4;
            font-weight: 600;
        }

        .edit-tab.nested {
            padding-left: 52px;
            font-size: 13px;
        }

        .menu-group {
            display: flex;
            flex-direction: column;
        }

        .menu-group-header {
            background: none;
            border: none;
            border-left: 3px solid transparent;
            text-align: left;
            padding: 12px 16px 12px 16px;
            font-size: 14px;
            color: #323130;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
        }

        .menu-group-header .chevron {
            width: 12px;
            height: 12px;
        }

        .menu-group-header:hover {
            background-color: #f3f2f1;
        }

        .menu-group-header .chevron {
            flex-shrink: 0;
            transition: transform 0.2s ease;
        }

        .menu-group-header .chevron.expanded {
            transform: rotate(0deg);
        }

        .menu-group-header .chevron:not(.expanded) {
            transform: rotate(-90deg);
        }

        .menu-group-items {
            display: flex;
            flex-direction: column;
        }

        .menu-group-items.hidden {
            display: none;
        }

        .edit-main-area {
            flex: 1;
            padding: 24px 32px;
            overflow-y: auto;
        }

        .form-section {
            max-width: 800px;
        }

        .section-label {
            font-size: 20px;
            font-weight: 600;
            color: #323130;
            margin: 0 0 24px 0;
        }

        .form-group-section {
            margin-bottom: 40px;
            display: flex;
            flex-direction: column;
        }

        #channelProfileDetails:not(.hidden),
        #routingProfileDetails:not(.hidden) {
            display: flex;
            flex-direction: column;
            gap: 0;
        }

        #channelProfileDetails .form-group-section,
        #routingProfileDetails .form-group-section {
            width: 100%;
            max-width: 800px;
        }

        #channelProfileDetails.hidden,
        #routingProfileDetails.hidden {
            display: none !important;
        }

        /* Profile Details Container */
        .profile-details-container {
            background-color: white;
            border: 1px solid #edebe9;
            border-radius: 4px;
            padding: 0;
            margin-top: 24px;
        }

        .profile-details-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 2px solid #edebe9;
            background-color: #faf9f8;
        }

        .profile-details-header .subsection-title {
            margin: 0;
        }

        .edit-icon-button {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background-color: #0078d4;
            color: white;
            border: none;
            border-radius: 2px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .edit-icon-button:hover {
            background-color: #106ebe;
        }

        .edit-icon-button.editing {
            background-color: #107c10;
        }

        .edit-icon-button.editing:hover {
            background-color: #0e6b0e;
        }

        .profile-details-content {
            padding: 24px;
        }

        .profile-details-content.read-only input:not([type="checkbox"]):not([type="radio"]),
        .profile-details-content.read-only select,
        .profile-details-content.read-only textarea {
            background-color: #f3f2f1;
            border-color: #d1d1d1;
            color: #605e5c;
            pointer-events: none;
        }

        .profile-details-content.read-only .form-link {
            pointer-events: none;
            color: #a19f9d;
        }

        .subsection-title {
            font-size: 16px;
            font-weight: 600;
            color: #323130;
            margin: 0 0 16px 0;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #323130;
            margin-bottom: 6px;
        }

        .required {
            color: #a80000;
        }

        .form-input,
        .form-select {
            width: 100%;
            max-width: 400px;
            height: 32px;
            padding: 0 8px;
            border: 1px solid #8a8886;
            border-radius: 2px;
            font-size: 14px;
            font-family: 'Segoe UI', sans-serif;
            background-color: white;
        }

        .form-input:focus,
        .form-select:focus {
            outline: 2px solid #0078d4;
            outline-offset: -2px;
            border-color: #0078d4;
        }

        .form-input:disabled,
        .form-select:disabled {
            background-color: #f3f2f1;
            color: #a19f9d;
            cursor: not-allowed;
        }

        .form-link {
            color: #0078d4;
            text-decoration: none;
            font-size: 14px;
        }

        .form-link:hover {
            text-decoration: underline;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .radio-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #323130;
            cursor: pointer;
        }

        .radio-label input[type="radio"] {
            margin: 0;
            cursor: pointer;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .slider-group {
            display: flex;
            align-items: center;
            gap: 12px;
            max-width: 400px;
        }

        .slider-label {
            font-size: 14px;
            color: #605e5c;
            min-width: 80px;
        }

        .slider {
            flex: 1;
            height: 4px;
            -webkit-appearance: none;
            appearance: none;
            background: #d1d1d1;
            border-radius: 2px;
            outline: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            background: #0078d4;
            cursor: pointer;
            border-radius: 50%;
        }

        .slider::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: #0078d4;
            cursor: pointer;
            border-radius: 50%;
            border: none;
        }

        .slider-value {
            font-size: 14px;
            color: #323130;
            font-weight: 600;
            min-width: 30px;
        }

        .placeholder-text {
            font-size: 14px;
            color: #605e5c;
            font-style: italic;
            margin: 0;
        }

        .hidden {
            display: none;
        }

        /* Help Text Box */
        .help-text-box {
            background-color: #f3f9fd;
            border: 1px solid #cfe4f5;
            border-left: 4px solid #0078d4;
            border-radius: 2px;
            padding: 16px;
            margin-bottom: 24px;
            width: calc(100vw - 200px);
            margin-left: -32px;
            padding-left: 48px;
            padding-right: 48px;
            display: flex;
            gap: 12px;
        }

        .info-icon {
            flex-shrink: 0;
            margin-top: 2px;
        }

        .help-text-content p {
            margin: 0 0 12px 0;
            font-size: 14px;
            color: #323130;
            line-height: 1.6;
        }

        .help-text-content p:last-child {
            margin-bottom: 0;
        }

        .help-text-content strong {
            font-weight: 600;
            color: #0078d4;
        }

        /* Profile Creation Box */
        .profile-creation-box {
            background-color: #faf9f8;
            border: 1px solid #edebe9;
            border-radius: 2px;
            padding: 20px;
            margin-top: 16px;
        }

        .button-group {
            display: flex;
            gap: 12px;
            margin-top: 16px;
        }

        .primary-button {
            background-color: #0078d4;
            color: white;
            border: none;
            border-radius: 2px;
            padding: 8px 16px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .primary-button:hover {
            background-color: #106ebe;
        }

        .secondary-button {
            background-color: white;
            color: #323130;
            border: 1px solid #8a8886;
            border-radius: 2px;
            padding: 8px 16px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .secondary-button:hover {
            background-color: #f3f2f1;
            border-color: #323130;
        }

        /* Configuration Summary */
        .configuration-summary {
            margin-top: 32px;
            padding-top: 24px;
            border-top: 2px solid #edebe9;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 16px;
            margin-top: 16px;
            margin-bottom: 24px;
        }

        .summary-card {
            background-color: white;
            border: 1px solid #edebe9;
            border-radius: 4px;
            padding: 16px;
            transition: box-shadow 0.2s ease;
        }

        .summary-card:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .summary-card-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid #edebe9;
        }

        .summary-card-header h4 {
            font-size: 14px;
            font-weight: 600;
            color: #323130;
            margin: 0;
        }

        .summary-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .summary-list li {
            font-size: 13px;
            color: #605e5c;
            line-height: 1.8;
            padding: 4px 0;
        }

        .summary-list li strong {
            color: #323130;
            font-weight: 600;
        }

        .status-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 2px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-badge.active {
            background-color: #dff6dd;
            color: #107c10;
        }

        .color-preview {
            display: inline-block;
            width: 16px;
            height: 16px;
            border-radius: 2px;
            border: 1px solid #edebe9;
            vertical-align: middle;
            margin-right: 4px;
        }

        .summary-actions {
            display: flex;
            gap: 12px;
            padding-top: 16px;
            border-top: 1px solid #edebe9;
        }

        /* Chat Widget */
        .chat-widget {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #0078d4;
            border-radius: 50px;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .chat-widget:hover {
            transform: scale(1.05);
        }

        .chat-widget-button {
            width: 40px;
            height: 40px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chat-widget-label {
            color: white;
            font-size: 16px;
            font-weight: 600;
        }

        .chat-widget-status {
            color: white;
            font-size: 12px;
            opacity: 0.9;
        }

        /* Visualizer Toggle Button */
        .visualizer-toggle-button {
            display: flex;
            align-items: center;
            gap: 6px;
            color: #0078d4;
            text-decoration: none;
            font-size: 14px;
            padding: 6px 12px;
            border-radius: 2px;
            background: none;
            border: 1px solid #0078d4;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
            margin-right: 12px;
        }

        .visualizer-toggle-button:hover {
            background-color: #0078d4;
            color: white;
        }

        .visualizer-toggle-button svg {
            flex-shrink: 0;
        }

        /* Visualizer Panel */
        .visualizer-panel {
            position: fixed;
            right: 0;
            top: 48px;
            width: 400px;
            height: calc(100vh - 48px);
            background-color: white;
            border-left: 2px solid #0078d4;
            box-shadow: -4px 0 12px rgba(0, 0, 0, 0.1);
            z-index: 50;
            display: flex;
            flex-direction: column;
            animation: slideIn 0.3s ease-out;
        }

        .visualizer-panel.hidden {
            display: none;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
            }
            to {
                transform: translateX(0);
            }
        }

        .visualizer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            border-bottom: 2px solid #edebe9;
            background-color: #faf9f8;
        }

        .visualizer-title {
            font-size: 18px;
            font-weight: 600;
            color: #323130;
            margin: 0;
        }

        .visualizer-close {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #605e5c;
        }

        .visualizer-close:hover {
            background-color: #edebe9;
            color: #323130;
        }

        .visualizer-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        /* Flow Diagram */
        .flow-diagram {
            display: flex;
            flex-direction: column;
            gap: 0;
            margin-bottom: 24px;
        }

        .flow-node {
            display: flex;
            gap: 12px;
            padding: 16px;
            background-color: white;
            border: 2px solid #edebe9;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .flow-node.active {
            border-color: #0078d4;
            background-color: #f3f9fd;
            box-shadow: 0 2px 8px rgba(0, 120, 212, 0.2);
        }

        .flow-node.configured {
            border-color: #107c10;
            background-color: #f3faf3;
        }

        .flow-node.pending {
            border-color: #d1d1d1;
            background-color: #faf9f8;
            opacity: 0.7;
        }

        .node-icon {
            flex-shrink: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #faf9f8;
            border-radius: 4px;
        }

        .flow-node.active .node-icon {
            background-color: #deecf9;
        }

        .flow-node.configured .node-icon {
            background-color: #dff6dd;
        }

        .node-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .node-title {
            font-size: 14px;
            font-weight: 600;
            color: #323130;
        }

        .node-subtitle {
            font-size: 12px;
            color: #605e5c;
        }

        .node-details {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 6px;
        }

        .detail-badge {
            display: inline-block;
            padding: 2px 8px;
            background-color: #deecf9;
            color: #0078d4;
            border-radius: 2px;
            font-size: 11px;
            font-weight: 600;
        }

        .flow-connector {
            width: 2px;
            height: 16px;
            background-color: #d1d1d1;
            margin: 0 auto;
        }

        .flow-node.active ~ .flow-connector,
        .flow-node.configured ~ .flow-connector {
            background-color: #107c10;
        }

        /* Configuration Status */
        .config-status {
            background-color: #faf9f8;
            border: 1px solid #edebe9;
            border-radius: 4px;
            padding: 16px;
        }

        .status-title {
            font-size: 14px;
            font-weight: 600;
            color: #323130;
            margin: 0 0 12px 0;
        }

        .status-items {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 13px;
            color: #323130;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .status-indicator.complete {
            background-color: #107c10;
        }

        .status-indicator.incomplete {
            background-color: #d1d1d1;
        }
        /* Visualizer Toggle Button */
        .visualizer-toggle-button {
            display: flex;
            align-items: center;
            gap: 6px;
            color: #0078d4;
            text-decoration: none;
            font-size: 14px;
            padding: 6px 12px;
            border-radius: 2px;
            background: none;
            border: 1px solid #0078d4;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
            margin-right: 12px;
        }

        .visualizer-toggle-button:hover {
            background-color: #0078d4;
            color: white;
        }

        .visualizer-toggle-button svg {
            flex-shrink: 0;
        }

        /* Visualizer Panel */
        .visualizer-panel {
            position: fixed;
            right: 0;
            top: 48px;
            width: 700px;
            height: calc(100vh - 48px);
            background-color: white;
            border-left: 2px solid #0078d4;
            box-shadow: -4px 0 12px rgba(0, 0, 0, 0.1);
            z-index: 50;
            display: flex;
            flex-direction: column;
            animation: slideIn 0.3s ease-out;
        }

        .visualizer-panel.hidden {
            display: none;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
            }
            to {
                transform: translateX(0);
            }
        }

        .visualizer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            border-bottom: 2px solid #edebe9;
            background-color: #faf9f8;
        }

        .visualizer-title {
            font-size: 18px;
            font-weight: 600;
            color: #323130;
            margin: 0;
        }

        .visualizer-close {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #605e5c;
        }

        .visualizer-close:hover {
            background-color: #edebe9;
            color: #323130;
        }

        .visualizer-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        /* Flow Diagram */
        .flow-diagram {
            display: flex;
            flex-direction: column;
            gap: 0;
            margin-bottom: 24px;
        }

        .flow-node {
            display: flex;
            gap: 12px;
            padding: 16px;
            background-color: white;
            border: 2px solid #edebe9;
            border-radius: 4px;
            transition: all 0.3s ease;
            max-width: 180px;
            margin: 0 auto;
        }

        .flow-node.active {
            border-color: #0078d4;
            background-color: #f3f9fd;
            box-shadow: 0 2px 8px rgba(0, 120, 212, 0.2);
        }

        .flow-node.configured {
            border-color: #107c10;
            background-color: #f3faf3;
        }

        .flow-node.pending {
            border-color: #d1d1d1;
            background-color: #faf9f8;
            opacity: 0.7;
        }

        .node-icon {
            flex-shrink: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #faf9f8;
            border-radius: 4px;
        }

        .flow-node.active .node-icon {
            background-color: #deecf9;
        }

        .flow-node.configured .node-icon {
            background-color: #dff6dd;
        }

        .node-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .node-title {
            font-size: 14px;
            font-weight: 600;
            color: #323130;
        }

        .node-subtitle {
            font-size: 12px;
            color: #605e5c;
        }

        .node-details {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 6px;
        }

        .detail-badge {
            display: inline-block;
            padding: 2px 8px;
            background-color: #deecf9;
            color: #0078d4;
            border-radius: 2px;
            font-size: 11px;
            font-weight: 600;
        }

        .flow-connector {
            width: 2px;
            height: 16px;
            background-color: #d1d1d1;
            margin: 0 auto;
        }

        .flow-node.active ~ .flow-connector,
        .flow-node.configured ~ .flow-connector {
            background-color: #107c10;
        }

        /* Queue Routing Section */
        .queue-routing-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0;
        }

        .queue-split-connector {
            width: 2px;
            height: 24px;
            background-color: #107c10;
            position: relative;
        }

        .queue-split-connector::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #107c10 0%, #107c10 50%, transparent 50%);
        }

        .queue-nodes-container {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: nowrap;
            padding: 12px 0;
            position: relative;
        }

        .queue-nodes-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 10%;
            right: 10%;
            height: 2px;
            background-color: #107c10;
        }

        .queue-nodes-container::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 10%;
            right: 10%;
            height: 2px;
            background-color: #107c10;
        }

        .queue-node {
            flex: 0 0 auto;
            min-width: 180px;
            position: relative;
        }

        .queue-node::before {
            content: '';
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 12px;
            background-color: #107c10;
        }

        .queue-node.pending::before {
            background-color: #d1d1d1;
        }

        .queue-node::after {
            content: '';
            position: absolute;
            bottom: -12px;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 12px;
            background-color: #107c10;
        }

        .queue-node.pending::after {
            background-color: #d1d1d1;
        }

        .queue-merge-connector {
            width: 2px;
            height: 24px;
            background-color: #107c10;
            position: relative;
        }

        .queue-merge-connector::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            height: 100%;
            background: linear-gradient(to top, #107c10 0%, #107c10 50%, transparent 50%);
        }

        /* Configuration Status */
        .config-status {
            background-color: #faf9f8;
            border: 1px solid #edebe9;
            border-radius: 4px;
            padding: 16px;
        }

        .status-title {
            font-size: 14px;
            font-weight: 600;
            color: #323130;
            margin: 0 0 12px 0;
        }

        .status-items {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 13px;
            color: #323130;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .status-indicator.complete {
            background-color: #107c10;
        }

        .status-indicator.incomplete {
            background-color: #d1d1d1;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <button class="waffle-menu" aria-label="Apps menu">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <circle cx="3" cy="3" r="2" />
                    <circle cx="10" cy="3" r="2" />
                    <circle cx="17" cy="3" r="2" />
                    <circle cx="3" cy="10" r="2" />
                    <circle cx="10" cy="10" r="2" />
                    <circle cx="17" cy="10" r="2" />
                    <circle cx="3" cy="17" r="2" />
                    <circle cx="10" cy="17" r="2" />
                    <circle cx="17" cy="17" r="2" />
                </svg>
            </button>
            <div class="header-title">Dynamics 365</div>
            <a href="#" class="header-subtitle">Copilot Service admin center</a>
        </div>
        <div class="header-center">
            <div class="search-box">
                <svg class="search-icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M11.5 6.5a5 5 0 1 1-10 0 5 5 0 0 1 10 0zm-1.27 4.27a6 6 0 1 1 1.06-1.06l3.5 3.5-1.06 1.06-3.5-3.5z" />
                </svg>
                <input type="text" placeholder="Search" class="search-input" />
            </div>
        </div>
        <div class="header-right">
            <button class="icon-button" aria-label="Notifications">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M10 2a6 6 0 0 1 6 6v3.58l1.71 1.71A1 1 0 0 1 17 15H3a1 1 0 0 1-.71-1.71L4 11.58V8a6 6 0 0 1 6-6zm2 14a2 2 0 1 1-4 0h4z" />
                </svg>
            </button>
            <button class="icon-button" aria-label="Add">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="10" y1="5" x2="10" y2="15" />
                    <line x1="5" y1="10" x2="15" y2="10" />
                </svg>
            </button>
            <button class="icon-button" aria-label="Settings">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5">
                    <circle cx="10" cy="10" r="3" />
                    <path d="M10 1v2m0 14v2M4.22 4.22l1.42 1.42m8.68 8.68l1.42 1.42M1 10h2m14 0h2M4.22 15.78l1.42-1.42m8.68-8.68l1.42-1.42" />
                </svg>
            </button>
            <button class="icon-button" aria-label="Help">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="1.5" fill="none" />
                    <path d="M10 14v.5M10 11a2 2 0 1 1 0-4 2 2 0 0 1 0 4v2" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round" />
                </svg>
            </button>
            <button class="icon-button" aria-label="Feedback">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <circle cx="10" cy="7" r="1.5" />
                    <path d="M7 13c0-1.5 1-3 3-3s3 1.5 3 3" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round" />
                </svg>
            </button>
            <button class="avatar-button">
                <span class="avatar">AU</span>
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="page-header-bar">
            <div class="header-bar-left">
                <button class="back-button" onclick="window.location.href='routing-profiles.html'">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M10 12L6 8l4-4" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </button>
                <button class="save-button">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M13 2H3a1 1 0 00-1 1v10a1 1 0 001 1h10a1 1 0 001-1V3a1 1 0 00-1-1zm-2 0v4H5V2h6zm1 11H4V3h1v4h6V3h1v10z" />
                    </svg>
                    Save and close
                </button>
            </div>
            <div class="header-bar-right">
                <button class="visualizer-toggle-button" onclick="toggleVisualizer()" id="visualizerToggle">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <rect x="2" y="2" width="5" height="5" stroke="currentColor" stroke-width="1.5" fill="none" />
                        <rect x="9" y="2" width="5" height="5" stroke="currentColor" stroke-width="1.5" fill="none" />
                        <rect x="2" y="9" width="5" height="5" stroke="currentColor" stroke-width="1.5" fill="none" />
                        <rect x="9" y="9" width="5" height="5" stroke="currentColor" stroke-width="1.5" fill="none" />
                    </svg>
                    <span id="visualizerToggleText">Show Visualizer</span>
                </button>
            </div>
        </div>

        <div class="page-header">
            <h1 class="edit-title">Editing Routing Profile</h1>
            <p class="edit-subtitle">Profile: Standard Routing Profile</p>
        </div>

        <div class="edit-content-layout">
            <div class="edit-main-area" style="margin-left: 0;">
                <!-- Routing profile -->
                <div class="form-section" id="section-routing">
                    <h2 class="section-label">Routing profile</h2>

                    <!-- Help Text -->
                    <div class="help-text-box">
                        <svg class="info-icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <circle cx="8" cy="8" r="7" stroke="#0078d4" stroke-width="1.5" fill="none" />
                            <path d="M8 11.5v-4M8 5.5v-.5" stroke="#0078d4" stroke-width="1.5" stroke-linecap="round" />
                        </svg>
                        <div class="help-text-content">
                            <p><strong>About Routing Profiles</strong></p>
                            <p>
                                Routing profiles control how incoming conversations are intelligently assigned to available agents.
                                Configure work classification, queue routing, capacity limits, skill matching, and fallback behaviors
                                to ensure optimal workload distribution and customer service quality.
                            </p>
                        </div>
                    </div>

                    <!-- Routing Profile Configuration Details -->
                    <div id="routingProfileDetails">
                        <div class="profile-details-container">
                            <div class="profile-details-header">
                                <h3 class="subsection-title">Profile Configuration</h3>
                                <button class="edit-icon-button" onclick="toggleRoutingProfileEdit()" id="routingProfileEditBtn">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M12.854 1.146a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.708-.708l10-10a.5.5 0 0 1 .708 0z"/>
                                        <path d="M11.5 1.5l3 3L5 14 2 15l1-3L11.5 1.5z" stroke="currentColor" stroke-width="1" fill="none"/>
                                    </svg>
                                    Edit
                                </button>
                            </div>
                            <div class="profile-details-content read-only" id="routingProfileContent">
                        <!-- Work Classification Rules -->
                    <div class="form-group-section">
                        <h3 class="subsection-title">Work Classification Rules</h3>
                        <p class="help-text-content" style="font-size: 13px; color: #605e5c; margin-bottom: 12px;">
                            Define rules to automatically classify incoming conversations based on customer intent, keywords, context,
                            or custom attributes. Classification determines priority levels, routing paths, and which queues or agents
                            should handle each conversation type.
                        </p>
                        <div class="form-group">
                            <label class="form-label">
                                Active Classification Rules
                            </label>
                            <div style="display: flex; flex-direction: column; gap: 8px; margin-top: 8px;">
                                <a href="#" class="form-link">→ High Priority Customer Rule</a>
                                <a href="#" class="form-link">→ Technical Issue Classification Rule</a>
                                <a href="#" class="form-link">→ Sales Inquiry Rule</a>
                                <a href="#" class="form-link">→ Billing & Payment Rule</a>
                            </div>
                        </div>
                        <div class="form-group" style="margin-top: 16px;">
                            <a href="#" class="form-link" style="font-weight: 600;">+ Add new classification rule</a>
                        </div>
                    </div>

                    <!-- Route-to-Queue Rules -->
                    <div class="form-group-section">
                        <h3 class="subsection-title">Route-to-Queue Rules</h3>
                        <p class="help-text-content" style="font-size: 13px; color: #605e5c; margin-bottom: 12px;">
                            Configure conditional logic to route conversations to specific queues based on classification results,
                            business hours, agent availability, customer attributes, or conversation metadata. Define primary
                            and alternate routing paths for different scenarios.
                        </p>
                        <div class="form-group">
                            <label class="form-label">
                                Primary Queue Routing
                            </label>
                            <select class="form-select">
                                <option value="">-- Select routing strategy --</option>
                                <option value="skill-based" selected>Skills-based routing</option>
                                <option value="priority">Priority-based routing</option>
                                <option value="round-robin">Round-robin distribution</option>
                                <option value="least-busy">Least busy agent</option>
                                <option value="custom">Custom routing rules</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <a href="#" class="form-link">Manage route-to-queue rules</a>
                        </div>
                    </div>

                    <!-- Allowed Presences -->
                    <div class="form-group-section">
                        <h3 class="subsection-title">Allowed Presences</h3>
                        <p class="help-text-content" style="font-size: 13px; color: #605e5c; margin-bottom: 12px;">
                            Specify which agent presence states are eligible to receive routed conversations from this channel.
                            For example, you can allow routing to agents in "Available" and "Busy" states but exclude those
                            in "Away" or "Do Not Disturb" states.
                        </p>
                        <div class="form-group">
                            <label class="form-label">
                                Allowed Presence States
                            </label>
                            <div style="display: flex; flex-direction: column; gap: 10px; margin-top: 8px;">
                                <label class="radio-label">
                                    <input type="checkbox" checked />
                                    <span>Available</span>
                                </label>
                                <label class="radio-label">
                                    <input type="checkbox" checked />
                                    <span>Busy</span>
                                </label>
                                <label class="radio-label">
                                    <input type="checkbox" />
                                    <span>Away</span>
                                </label>
                                <label class="radio-label">
                                    <input type="checkbox" />
                                    <span>Be Right Back</span>
                                </label>
                                <label class="radio-label">
                                    <input type="checkbox" />
                                    <span>Do Not Disturb</span>
                                </label>
                                <label class="radio-label">
                                    <input type="checkbox" />
                                    <span>Offline</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Capacity Profile -->
                    <div class="form-group-section">
                        <h3 class="subsection-title">Capacity Profile</h3>
                        <p class="help-text-content" style="font-size: 13px; color: #605e5c; margin-bottom: 12px;">
                            Control the maximum concurrent conversation load for agents receiving work from this channel.
                            Capacity profiles define limits per agent, capacity units consumed by conversation types, and
                            load balancing strategies to prevent agent burnout and maintain service quality.
                        </p>
                        <div class="form-group">
                            <label class="form-label">
                                Capacity Profile
                            </label>
                            <select class="form-select">
                                <option value="default" selected>Default Capacity (5 concurrent)</option>
                                <option value="high">High Volume Capacity (10 concurrent)</option>
                                <option value="low">Low Volume Capacity (3 concurrent)</option>
                                <option value="custom">Custom Capacity Profile</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">
                                Capacity Units per Conversation
                            </label>
                            <input type="number" class="form-input" value="10" min="1" max="100" />
                        </div>
                        <div class="form-group">
                            <a href="#" class="form-link">Manage capacity profiles</a>
                        </div>
                    </div>

                    <!-- Skill Matching Algorithm -->
                    <div class="form-group-section">
                        <h3 class="subsection-title">Skill Matching Algorithm</h3>
                        <p class="help-text-content" style="font-size: 13px; color: #605e5c; margin-bottom: 12px;">
                            Select the algorithm used to match conversation requirements with agent skills. Exact match requires
                            all skills to match perfectly, nearest match finds the closest skill set available, or choose none
                            to disable skill-based routing for this profile.
                        </p>
                        <div class="form-group">
                            <label class="form-label">
                                Matching Algorithm
                            </label>
                            <select class="form-select">
                                <option value="exact-match">Exact match</option>
                                <option value="nearest-match" selected>Nearest match</option>
                                <option value="none">None</option>
                            </select>
                        </div>
                    </div>

                    <!-- Fallback Queue -->
                    <div class="form-group-section">
                        <h3 class="subsection-title">Fallback Queue</h3>
                        <p class="help-text-content" style="font-size: 13px; color: #605e5c; margin-bottom: 12px;">
                            Designate a fallback queue to receive conversations when primary routing fails, no agents match
                            the skill requirements, or capacity limits are reached across all primary queues. This ensures
                            conversations are never dropped or left unassigned.
                        </p>
                        <div class="form-group">
                            <label class="form-label">
                                Fallback Queue
                            </label>
                            <select class="form-select">
                                <option value="">-- No fallback queue --</option>
                                <option value="general-queue" selected>General Support Queue</option>
                                <option value="overflow-queue">Overflow Queue</option>
                                <option value="escalation-queue">Escalation Queue</option>
                                <option value="supervisor-queue">Supervisor Queue</option>
                            </select>
                        </div>
                    </div>

                    <!-- Rule-Hit Policy -->
                    <div class="form-group-section">
                        <h3 class="subsection-title">Rule-Hit Policy</h3>
                        <p class="help-text-content" style="font-size: 13px; color: #605e5c; margin-bottom: 12px;">
                            Define how the system behaves when multiple routing rules match a single conversation. Choose
                            hit-first to apply only the first matching rule, or hit-all to aggregate results from all matching
                            rules for comprehensive routing decisions.
                        </p>
                        <div class="form-group">
                            <label class="form-label">
                                Policy Type
                            </label>
                            <select class="form-select">
                                <option value="hit-first" selected>hit-first</option>
                                <option value="hit-all">hit-all</option>
                            </select>
                        </div>
                    </div>
                            </div><!-- End profile-details-content -->
                        </div><!-- End profile-details-container -->
                    </div><!-- End Routing Profile Configuration Details -->
                </div>
            </div>
        </div>
    </main>

    <!-- Visualizer Panel -->
    <div class="visualizer-panel hidden" id="visualizerPanel">
        <div class="visualizer-header">
            <h3 class="visualizer-title">Configuration Flow</h3>
            <button class="visualizer-close" onclick="toggleVisualizer()">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M4 4l8 8M12 4l-8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
            </button>
        </div>
        <div class="visualizer-content">
            <!-- Flow Diagram -->
            <div class="flow-diagram">
                <!-- Start Node -->
                <div class="flow-node start-node">
                    <div class="node-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <circle cx="12" cy="12" r="8" fill="#107c10" />
                            <path d="M10 8l6 4-6 4z" fill="white" />
                        </svg>
                    </div>
                    <div class="node-content">
                        <div class="node-title">Start</div>
                        <div class="node-subtitle">Chat Initiated</div>
                    </div>
                </div>

                <div class="flow-connector"></div>

                <!-- Channel Configuration Node -->
                <div class="flow-node config-node configured" id="configNode">
                    <div class="node-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <rect x="4" y="4" width="16" height="16" rx="2" stroke="#0078d4" stroke-width="2" fill="none" />
                            <path d="M8 8h8M8 12h8M8 16h4" stroke="#0078d4" stroke-width="1.5" stroke-linecap="round" />
                        </svg>
                    </div>
                    <div class="node-content">
                        <div class="node-title">Channel Configuration</div>
                        <div class="node-subtitle" id="configSubtitle">Default Layout</div>
                    </div>
                </div>

                <div class="flow-connector"></div>

                <!-- Channel Profile Node -->
                <div class="flow-node profile-node pending" id="channelProfileNode">
                    <div class="node-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <circle cx="12" cy="8" r="4" stroke="#0078d4" stroke-width="2" fill="none" />
                            <path d="M5 20c0-4 3-7 7-7s7 3 7 7" stroke="#0078d4" stroke-width="2" fill="none" stroke-linecap="round" />
                        </svg>
                    </div>
                    <div class="node-content">
                        <div class="node-title">Channel Profile</div>
                        <div class="node-subtitle" id="channelProfileSubtitle">Not configured</div>
                        <div class="node-details" id="channelProfileDetails" style="display: none;">
                            <span class="detail-badge">CSR Experience</span>
                            <span class="detail-badge">Customer Features</span>
                        </div>
                    </div>
                </div>

                <div class="flow-connector"></div>

                <!-- Routing Profile Node -->
                <div class="flow-node routing-node configured" id="routingProfileNode">
                    <div class="node-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2l-8 6v8l8 6 8-6V8z" stroke="#0078d4" stroke-width="2" fill="none" />
                            <circle cx="12" cy="12" r="3" fill="#0078d4" />
                        </svg>
                    </div>
                    <div class="node-content">
                        <div class="node-title">Routing Profile</div>
                        <div class="node-subtitle" id="routingProfileSubtitle">Standard Routing Profile</div>
                        <div class="node-details" id="routingProfileDetails" style="display: flex;">
                            <span class="detail-badge">Skills Matching</span>
                            <span class="detail-badge">Load Balancing</span>
                        </div>
                    </div>
                </div>

                <div class="flow-connector"></div>

                <!-- Queue Routing Section -->
                <div class="queue-routing-section">
                    <div class="queue-split-connector"></div>

                    <div class="queue-nodes-container">
                        <!-- Queue 1 -->
                        <div class="flow-node queue-node configured" id="queue1Node">
                            <div class="node-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                    <rect x="4" y="5" width="16" height="3" rx="1" fill="#0078d4" />
                                    <rect x="4" y="10" width="16" height="3" rx="1" fill="#0078d4" />
                                    <rect x="4" y="15" width="16" height="3" rx="1" fill="#0078d4" />
                                </svg>
                            </div>
                            <div class="node-content">
                                <div class="node-title">Queue 1</div>
                                <div class="node-subtitle">General Support</div>
                            </div>
                        </div>

                        <!-- Queue 2 -->
                        <div class="flow-node queue-node configured" id="queue2Node">
                            <div class="node-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                    <rect x="4" y="5" width="16" height="3" rx="1" fill="#0078d4" />
                                    <rect x="4" y="10" width="16" height="3" rx="1" fill="#0078d4" />
                                    <rect x="4" y="15" width="16" height="3" rx="1" fill="#0078d4" />
                                </svg>
                            </div>
                            <div class="node-content">
                                <div class="node-title">Queue 2</div>
                                <div class="node-subtitle">Technical Support</div>
                            </div>
                        </div>

                        <!-- Queue 3 -->
                        <div class="flow-node queue-node configured" id="queue3Node">
                            <div class="node-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                    <rect x="4" y="5" width="16" height="3" rx="1" fill="#0078d4" />
                                    <rect x="4" y="10" width="16" height="3" rx="1" fill="#0078d4" />
                                    <rect x="4" y="15" width="16" height="3" rx="1" fill="#0078d4" />
                                </svg>
                            </div>
                            <div class="node-content">
                                <div class="node-title">Queue 3</div>
                                <div class="node-subtitle">Premium Support</div>
                            </div>
                        </div>
                    </div>

                    <div class="queue-merge-connector"></div>
                </div>

                <div class="flow-connector"></div>

                <!-- Agent Assignment Node -->
                <div class="flow-node agent-node configured" id="agentAssignmentNode">
                    <div class="node-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <circle cx="12" cy="8" r="3" fill="#0078d4" />
                            <path d="M6 20c0-3 2.5-5 6-5s6 2 6 5" stroke="#0078d4" stroke-width="2" fill="none" stroke-linecap="round" />
                            <circle cx="18" cy="6" r="2" fill="#107c10" />
                        </svg>
                    </div>
                    <div class="node-content">
                        <div class="node-title">Agent Assignment</div>
                        <div class="node-subtitle">Route to Available Agent</div>
                    </div>
                </div>

                <div class="flow-connector"></div>

                <!-- End Node -->
                <div class="flow-node end-node">
                    <div class="node-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <circle cx="12" cy="12" r="8" fill="#d13438" />
                            <rect x="8" y="11" width="8" height="2" fill="white" />
                        </svg>
                    </div>
                    <div class="node-content">
                        <div class="node-title">End</div>
                        <div class="node-subtitle">Chat Completed</div>
                    </div>
                </div>
            </div>

            <!-- Configuration Status -->
            <div class="config-status">
                <h4 class="status-title">Configuration Status</h4>
                <div class="status-items">
                    <div class="status-item">
                        <div class="status-indicator complete"></div>
                        <span>Channel Configuration</span>
                    </div>
                    <div class="status-item">
                        <div class="status-indicator incomplete" id="channelProfileStatus"></div>
                        <span>Channel Profile</span>
                    </div>
                    <div class="status-item">
                        <div class="status-indicator complete" id="routingProfileStatus"></div>
                        <span>Routing Profile</span>
                    </div>
                    <div class="status-item">
                        <div class="status-indicator complete" id="queueStatus"></div>
                        <span>Queue Routing</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function setActiveTab(button) {
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.edit-tab');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Add active class to clicked tab
            button.classList.add('active');

            // Hide all sections
            const sections = document.querySelectorAll('.form-section');
            sections.forEach(section => section.classList.add('hidden'));

            // Show the appropriate section based on tab text
            const tabText = button.textContent.trim();
            let sectionId = '';

            if (tabText === 'General Configuration') {
                sectionId = 'section-general';
            } else if (tabText === 'Color Settings') {
                sectionId = 'section-color';
            } else if (tabText === 'Header') {
                sectionId = 'section-header';
            } else if (tabText === 'Chat widget') {
                sectionId = 'section-widget';
            } else if (tabText === 'Channel profile') {
                sectionId = 'section-profile';
            } else if (tabText === 'Routing profile') {
                sectionId = 'section-routing';
            }

            if (sectionId) {
                document.getElementById(sectionId).classList.remove('hidden');
            }

            // Update visualizer active state
            updateVisualizerActiveTab(tabText);
        }

        function toggleMenuGroup(button) {
            const chevron = button.querySelector('.chevron');
            const menuItems = button.nextElementSibling;

            chevron.classList.toggle('expanded');
            menuItems.classList.toggle('hidden');
        }

        function updateSliderValue(value) {
            document.getElementById('sliderValue').textContent = value;
        }

        function handleProfileSelection(value) {
            const creationBox = document.getElementById('profileCreationBox');
            const detailsBox = document.getElementById('channelProfileDetails');
            const contentBox = document.getElementById('channelProfileContent');
            const editBtn = document.getElementById('channelProfileEditBtn');

            if (value === 'create-new') {
                creationBox.classList.remove('hidden');
                detailsBox.classList.add('hidden');
            } else if (value === '') {
                creationBox.classList.add('hidden');
                detailsBox.classList.add('hidden');
            } else {
                creationBox.classList.add('hidden');
                detailsBox.classList.remove('hidden');

                // Set to read-only mode by default
                contentBox.classList.add('read-only');
                editBtn.classList.remove('editing');
                editBtn.innerHTML = '<svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M12.854 1.146a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.708-.708l10-10a.5.5 0 0 1 .708 0z"/><path d="M11.5 1.5l3 3L5 14 2 15l1-3L11.5 1.5z" stroke="currentColor" stroke-width="1" fill="none"/></svg>Edit';
            }

            // Update visualizer
            updateVisualizerChannelProfile(value);
        }

        function toggleChannelProfileEdit() {
            const contentBox = document.getElementById('channelProfileContent');
            const editBtn = document.getElementById('channelProfileEditBtn');

            if (contentBox.classList.contains('read-only')) {
                // Switch to edit mode
                contentBox.classList.remove('read-only');
                editBtn.classList.add('editing');
                editBtn.innerHTML = '<svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M13 2L3 12v3h3L16 5l-3-3zM3 13.5L2 15l1.5-1L3 13.5z" stroke="currentColor" stroke-width="1" fill="white"/></svg>Save';
            } else {
                // Switch to read-only mode
                contentBox.classList.add('read-only');
                editBtn.classList.remove('editing');
                editBtn.innerHTML = '<svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M12.854 1.146a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.708-.708l10-10a.5.5 0 0 1 .708 0z"/><path d="M11.5 1.5l3 3L5 14 2 15l1-3L11.5 1.5z" stroke="currentColor" stroke-width="1" fill="none"/></svg>Edit';
            }
        }

        function createProfile() {
            const profileName = document.getElementById('newProfileName').value.trim();
            if (profileName) {
                // Hide creation box
                document.getElementById('profileCreationBox').classList.add('hidden');

                // Show details
                document.getElementById('channelProfileDetails').classList.remove('hidden');

                // Set to read-only mode by default
                const contentBox = document.getElementById('channelProfileContent');
                const editBtn = document.getElementById('channelProfileEditBtn');
                contentBox.classList.add('read-only');
                editBtn.classList.remove('editing');
                editBtn.innerHTML = '<svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M12.854 1.146a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.708-.708l10-10a.5.5 0 0 1 .708 0z"/><path d="M11.5 1.5l3 3L5 14 2 15l1-3L11.5 1.5z" stroke="currentColor" stroke-width="1" fill="none"/></svg>Edit';

                // Reset the select dropdown
                const select = document.getElementById('channelProfileSelect');
                select.value = 'default-profile';

                // Clear input
                document.getElementById('newProfileName').value = '';

                // Update visualizer
                updateVisualizerChannelProfile('default-profile');

                alert('Profile "' + profileName + '" created successfully!');
            } else {
                alert('Please enter a profile name.');
            }
        }

        function cancelProfileCreation() {
            document.getElementById('profileCreationBox').classList.add('hidden');
            document.getElementById('channelProfileDetails').classList.add('hidden');
            document.getElementById('newProfileName').value = '';

            // Reset the select dropdown to default
            const select = document.getElementById('channelProfileSelect');
            select.value = '';
            updateVisualizerChannelProfile('');
        }

        function handleRoutingProfileSelection(value) {
            const creationBox = document.getElementById('routingProfileCreationBox');
            const detailsBox = document.getElementById('routingProfileDetails');
            const contentBox = document.getElementById('routingProfileContent');
            const editBtn = document.getElementById('routingProfileEditBtn');

            if (value === 'create-new') {
                creationBox.classList.remove('hidden');
                detailsBox.classList.add('hidden');
            } else if (value === '') {
                creationBox.classList.add('hidden');
                detailsBox.classList.add('hidden');
            } else {
                creationBox.classList.add('hidden');
                detailsBox.classList.remove('hidden');

                // Set to read-only mode by default
                contentBox.classList.add('read-only');
                editBtn.classList.remove('editing');
                editBtn.innerHTML = '<svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M12.854 1.146a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.708-.708l10-10a.5.5 0 0 1 .708 0z"/><path d="M11.5 1.5l3 3L5 14 2 15l1-3L11.5 1.5z" stroke="currentColor" stroke-width="1" fill="none"/></svg>Edit';
            }

            // Update visualizer
            updateVisualizerRoutingProfile(value);
        }

        function toggleRoutingProfileEdit() {
            const contentBox = document.getElementById('routingProfileContent');
            const editBtn = document.getElementById('routingProfileEditBtn');

            if (contentBox.classList.contains('read-only')) {
                // Switch to edit mode
                contentBox.classList.remove('read-only');
                editBtn.classList.add('editing');
                editBtn.innerHTML = '<svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M13 2L3 12v3h3L16 5l-3-3zM3 13.5L2 15l1.5-1L3 13.5z" stroke="currentColor" stroke-width="1" fill="white"/></svg>Save';
            } else {
                // Switch to read-only mode
                contentBox.classList.add('read-only');
                editBtn.classList.remove('editing');
                editBtn.innerHTML = '<svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M12.854 1.146a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.708-.708l10-10a.5.5 0 0 1 .708 0z"/><path d="M11.5 1.5l3 3L5 14 2 15l1-3L11.5 1.5z" stroke="currentColor" stroke-width="1" fill="none"/></svg>Edit';
            }
        }

        function createRoutingProfile() {
            const profileName = document.getElementById('newRoutingProfileName').value.trim();
            if (profileName) {
                // Hide creation box
                document.getElementById('routingProfileCreationBox').classList.add('hidden');

                // Show details
                document.getElementById('routingProfileDetails').classList.remove('hidden');

                // Set to read-only mode by default
                const contentBox = document.getElementById('routingProfileContent');
                const editBtn = document.getElementById('routingProfileEditBtn');
                contentBox.classList.add('read-only');
                editBtn.classList.remove('editing');
                editBtn.innerHTML = '<svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M12.854 1.146a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.708-.708l10-10a.5.5 0 0 1 .708 0z"/><path d="M11.5 1.5l3 3L5 14 2 15l1-3L11.5 1.5z" stroke="currentColor" stroke-width="1" fill="none"/></svg>Edit';

                // Reset the select dropdown
                const select = document.getElementById('routingProfileSelect');
                select.value = 'standard-routing';

                // Clear input
                document.getElementById('newRoutingProfileName').value = '';

                // Update visualizer
                updateVisualizerRoutingProfile('standard-routing');

                alert('Profile "' + profileName + '" created successfully!');
            } else {
                alert('Please enter a profile name.');
            }
        }

        function cancelRoutingProfileCreation() {
            document.getElementById('routingProfileCreationBox').classList.add('hidden');
            document.getElementById('routingProfileDetails').classList.add('hidden');
            document.getElementById('newRoutingProfileName').value = '';

            // Reset the select dropdown to default
            const select = document.getElementById('routingProfileSelect');
            select.value = '';
            updateVisualizerRoutingProfile('');
        }

        // Visualizer Functions
        function toggleVisualizer() {
            const panel = document.getElementById('visualizerPanel');
            const toggleText = document.getElementById('visualizerToggleText');

            if (panel.classList.contains('hidden')) {
                panel.classList.remove('hidden');
                toggleText.textContent = 'Hide Visualizer';
            } else {
                panel.classList.add('hidden');
                toggleText.textContent = 'Show Visualizer';
            }
        }

        function updateVisualizerChannelProfile(value) {
            const node = document.getElementById('channelProfileNode');
            const subtitle = document.getElementById('channelProfileSubtitle');
            const details = document.getElementById('channelProfileDetails');
            const status = document.getElementById('channelProfileStatus');

            if (value && value !== 'create-new') {
                node.classList.remove('pending');
                node.classList.add('configured');
                details.style.display = 'flex';
                status.classList.remove('incomplete');
                status.classList.add('complete');

                // Update subtitle based on selection
                if (value === 'default-profile') {
                    subtitle.textContent = 'Default Chat Profile';
                } else if (value === 'premium-support') {
                    subtitle.textContent = 'Premium Support';
                } else if (value === 'basic-support') {
                    subtitle.textContent = 'Basic Support';
                } else if (value === 'technical-support') {
                    subtitle.textContent = 'Technical Support';
                } else {
                    subtitle.textContent = 'Selected';
                }
            } else {
                node.classList.add('pending');
                node.classList.remove('configured');
                subtitle.textContent = 'Not configured';
                details.style.display = 'none';
                status.classList.add('incomplete');
                status.classList.remove('complete');
            }
        }

        function updateVisualizerRoutingProfile(value) {
            const node = document.getElementById('routingProfileNode');
            const subtitle = document.getElementById('routingProfileSubtitle');
            const details = document.getElementById('routingProfileDetails');
            const status = document.getElementById('routingProfileStatus');

            if (value && value !== 'create-new') {
                node.classList.remove('pending');
                node.classList.add('configured');
                details.style.display = 'flex';
                status.classList.remove('incomplete');
                status.classList.add('complete');

                // Update subtitle based on selection
                if (value === 'standard-routing') {
                    subtitle.textContent = 'Standard Routing';
                } else if (value === 'priority-routing') {
                    subtitle.textContent = 'Priority Routing';
                } else if (value === 'skill-based') {
                    subtitle.textContent = 'Skill-Based Routing';
                } else if (value === 'round-robin') {
                    subtitle.textContent = 'Round Robin';
                } else {
                    subtitle.textContent = 'Selected';
                }
            } else {
                node.classList.add('pending');
                node.classList.remove('configured');
                subtitle.textContent = 'Not configured';
                details.style.display = 'none';
                status.classList.add('incomplete');
                status.classList.remove('complete');
            }
        }

        function updateVisualizerActiveTab(tabText) {
            // Reset all nodes to configured state
            const configNode = document.getElementById('configNode');
            const channelProfileNode = document.getElementById('channelProfileNode');
            const routingProfileNode = document.getElementById('routingProfileNode');

            configNode.classList.remove('active');
            channelProfileNode.classList.remove('active');
            routingProfileNode.classList.remove('active');

            // Set active based on current tab
            if (tabText === 'General Configuration' || tabText === 'Color Settings' ||
                tabText === 'Header' || tabText === 'Chat widget') {
                configNode.classList.add('active');
            } else if (tabText === 'Channel profile') {
                // Keep current state (configured or pending)
                const currentClasses = channelProfileNode.className;
                if (!currentClasses.includes('pending')) {
                    channelProfileNode.classList.add('active');
                }
            } else if (tabText === 'Routing profile') {
                // Keep current state (configured or pending)
                const currentClasses = routingProfileNode.className;
                if (!currentClasses.includes('pending')) {
                    routingProfileNode.classList.add('active');
                }
            }
        }

        // Visualizer Functions
        function toggleVisualizer() {
            const panel = document.getElementById('visualizerPanel');
            const toggleText = document.getElementById('visualizerToggleText');

            if (panel.classList.contains('hidden')) {
                panel.classList.remove('hidden');
                toggleText.textContent = 'Hide Visualizer';
            } else {
                panel.classList.add('hidden');
                toggleText.textContent = 'Show Visualizer';
            }
        }
    </script>
</body>
</html>
